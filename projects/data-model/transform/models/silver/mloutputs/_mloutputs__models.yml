# DOCUMENTATION: https://docs.getdbt.com/reference/model-properties

version: 2

models:
  - name: mloutputs__preselector_successful_realtime_output
    description: "Table of all successful preselector outputs."
    columns:
      - name: preselector_output_id
        data_type: string
        description: "{{ doc('column__preselector_output_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: billing_agreement_id
        data_type: int
        description: "{{ doc('column__billing_agreement_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: company_id
        data_type: string
        description: "{{ doc('column__company_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: taste_preference_compliancy_code
        data_type: int
        description: "{{ doc('column__taste_preference_compliancy_code') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
          - accepted_values:
              values: [1, 2, 3]
              quote: false

      - name: concept_preference_ids
        data_type: array<string>
        description: "{{ doc('column__concept_preference_list') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: main_recipe_ids
        data_type: array<string>
        description: "{{ doc('column__main_recipe_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: model_version_commit_sha
        data_type: string
        description: "{{ doc('column__model_version_commit_sha') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: portions
        data_type: int
        description: "{{ doc('column__requested_portions') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
          - accepted_values:
              values: [1, 2, 3, 4, 5, 6]
              quote: false

      - name: meals
        data_type: int
        description: "{{ doc('column__requested_meals') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
          - accepted_values:
              values: [2, 3, 4, 5]
              quote: false

      - name: taste_preference_ids
        data_type: array<string>
        description: "{{ doc('column__taste_preference_list') }}"

      - name: product_variation_ids
        data_type: array<string>
        description: "{{ doc('column__product_variation_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: menu_week
        data_type: int
        description: "{{ doc('column__menu_week') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: menu_year
        data_type: int
        description: "{{ doc('column__menu_year') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: menu_week_monday_date
        data_type: date
        description: "{{ doc('column__menu_week_monday_date') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: target_cost_of_food_per_meal
        data_type: double
        description: "{{ doc('column__target_cost_of_food_per_meal') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: has_data_processing_consent
        data_type: boolean
        description: "{{ doc('column__has_data_processing_consent') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: is_override_deviation
        data_type: boolean
        description: "{{ doc('column__is_override_deviation') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: error_cooking_time_mean
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_beef_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_chef_choice_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_chicken_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_cod_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_family_friendly_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_gluten_free_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_grain_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_lactose_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_lamb_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_low_calorie
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_mixed_meat_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_other_carbo_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_other_protein_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_pasta_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_pork_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_roede_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_salmon_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_seafood_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_shrimp_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_soft_bread_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_spicy_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_tuna_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_vegan_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_vegetables_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_is_vegetarian_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_cost_of_food
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_energy
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_fat
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_fat_saturated
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_number_of_ratings
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_ordered_ago
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_protein
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_rank
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_ratings
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_mean_veg_fruit
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 100

      - name: error_repeated_proteins_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 1

      - name: error_repeated_carbohydrates_percentage
        data_type: double
        description: "{{ doc('column__preselector_error_vector') }}"
        data_tests:
          - dbt_utils.accepted_range:
              min_value: 0
              max_value: 1

      - name: menu_week_output_version
        data_type: int
        description: "{{ doc('column__menu_week_output_version') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: is_most_recent_output
        data_type: int
        description: "{{ doc('column__is_most_recent_output') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
          - accepted_values:
              values: [0, 1]

      - name: created_at
        data_type: timestamp
        description: "{{ doc('column__created_at_preselector_output') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

  - name: mloutputs__preselector_failed_realtime_output
    description: "Table of all failed preselector outputs."
    columns:
      - name: billing_agreement_id
        data_type: bigint
        description: "{{ doc('column__billing_agreement_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: company_id
        data_type: string
        description: "{{ doc('column__company_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: menu_year_weeks
        data_type: array<struct<week:int,year:int>>
        description: "{{ doc('column__requested_menu_year_weeks') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: concept_preference_ids
        data_type: array<string>
        description: "{{ doc('column__concept_preference_list') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: taste_preference_ids
        data_type: array<string>
        description: "{{ doc('column__taste_preference_list') }}"

      - name: portions
        data_type: int
        description: "{{ doc('column__requested_portions') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
          - accepted_values:
              values: [1, 2, 3, 4, 5, 6]
              quote: false

      - name: meals
        data_type: int
        description: "{{ doc('column__requested_meals') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
          - accepted_values:
              values: [2, 3, 4, 5]
              quote: false

      - name: is_override_deviation
        data_type: boolean
        description: "{{ doc('column__is_override_deviation') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: main_recipe_quarantining_control
        data_type: map<string,int>
        description: "{{ doc('column__main_recipe_quarantining_control') }}"

      - name: has_data_processing_consent
        data_type: boolean
        description: "{{ doc('column__has_data_processing_consent') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: correlation_id
        data_type: string
        description: "{{ doc('column__correlation_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: error_message
        data_type: string
        description: "{{ doc('column__preselector_error_message') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: error_code
        data_type: bigint
        description: "{{ doc('column__preselector_error_code') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 1
              max_value: 500
