models:
  - name: operations__orders_history

  - name: operations__orders

  - name: operations__transport_companies
    description: "Contains information about the transport companies that are used for deliveries"
    config:
      contract:
        enforced: true

    columns:
      - name: transport_company_id
        data_type: int
        description: "{{ doc('column__transport_company_id') }}"
        data_tests:
          - unique
          - not_null

      - name: transport_company_name
        data_type: varchar(100)
        description: "{{ doc('column__transport_company_name') }}"
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"
        data_tests:
          - not_null

      - name: source_created_by
        data_type: varchar(50)
        description: "{{ doc('column__source_created_by') }}"
        data_tests:
          - not_null

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"

      - name: source_updated_by
        data_type: varchar(50)
        description: "{{ doc('column__source_updated_by') }}"

  - name: operations__distribution_centers
    description: "Has information about distribution centers which are ??"
    config:
      contract:
        enforced: true

    columns:
      - name: distribution_center_id
        data_type: char(36)
        description: "{{ doc('column__distribution_center_id') }}"
        data_tests:
          - unique
          - not_null

      - name: distribution_center_type_id
        data_type: char(36)
        description: "{{ doc('column__distribution_center_type_id') }}"
        data_tests:
          - not_null

      - name: transport_company_id
        data_type: int
        description: "{{ doc('column__transport_company_id') }}"

      - name: country_id
        data_type: string
        description: "{{ doc('column__country_id') }}"
        data_tests:
          - not_null

      - name: distribution_center_name
        data_type: string
        description: "{{ doc('column__distribution_center_name') }}"
        data_tests:
          - not_null

      - name: distribution_center_postal_code
        data_type: string
        description: "{{ doc('column__distribution_center_postal_code') }}"
        data_tests:
          - not_null

      - name: distribution_center_latitude
        data_type: decimal(9,6)
        description: "{{ doc('column__distribution_center_latitude') }}"

      - name: distribution_center_longitude
        data_type: decimal(9,6)
        description: "{{ doc('column__distribution_center_longitude') }}"

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"
        data_tests:
          - not_null

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"
        data_tests:
          - not_null

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        data_tests:
          - not_null

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"
        data_tests:
          - not_null

  - name: operations__distribution_center_types
    description: "Has information about distribution different types. Which are ??"
    config:
      contract:
        enforced: true

    columns:
      - name: distribution_center_type_id
        data_type: char(36)
        description: "{{ doc('column__distribution_center_type_id') }}"
        data_tests:
          - unique
          - not_null

      - name: distribution_center_type__name
        data_type: string
        description: "{{ doc('column__distribution_center_type__name') }}"
        data_tests:
          - not_null
  
  - name: operations__timeblocks_blacklisted
    description: Contains blacklisted timeblocks for given menu year and menu week.
    columns:
      - name: timeblocks_blacklisted_id
        data_type: varchar(36)
        description: "{{ doc('column__timeblocks_blacklisted_id') }}"
        data_tests:
          - unique
          - not_null

      - name: company_id
        data_type: varchar(36)
        description: "{{ doc('column__company_id') }}"
        data_tests:
          - not_null

      - name: menu_year
        data_type: int
        description: "{{ doc('column__menu_year') }}"
        data_tests:
          - not_null

      - name: menu_week
        data_type: int
        description: "{{ doc('column__menu_week') }}"
        data_tests:
          - not_null

      - name: timeblock_id
        data_type: int
        description: "{{ doc('column__timeblock_id') }}"
        data_tests:
          - not_null

      - name: fallback_timeblock_id
        data_type: int
        description: "{{ doc('column__fallback_timeblock_id') }}"
        

  - name: operations__timeblocks_blacklisted_zones
    description: Table of zones that belong to a blacklisted timeblock.
    columns:
      - name: timeblocks_blacklisted_id
        data_type: varchar(36)
        description: "{{ doc('column__timeblocks_blacklisted_id') }}"
        data_tests:
          - not_null

      - name: zone_id
        data_type: int
        description: "{{ doc('column__zone_id') }}"
        data_tests:
          - not_null

  - name: operations__zones_postal_codes
    description: Table that maps postal codes to delivery zones. Each row represents a postal code that is serviced by a specific delivery zone.
    columns:
      - name: zone_id
        data_type: int
        description: "{{ doc('column__zone_id') }}"
        data_tests:
          - not_null

      - name: postal_code_id
        data_type: int
        description: "{{ doc('column__postal_code_id') }}"
        data_tests:
          - not_null
      
      - name: country_id
        data_type: varchar(36)
        description: "{{ doc('column__country_id') }}"
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"
        
  - name: operations__postal_codes
    description: Table of postal codes in the operations database.
    data_tests:
      - unique:
          column_name: "(postal_code_id || '-' || country_id)"
    columns:
      - name: postal_code_id
        data_type: int
        description: "{{ doc('column__postal_code_id') }}"
        data_tests:
          - not_null

      - name: country_id
        data_type: varchar(36)
        description: "{{ doc('column__country_id') }}"
        data_tests:
          - not_null

      - name: postal_code
        data_type: string
        description: "{{ doc('column__postal_code') }}"
        data_tests:
          - not_null

      - name: city_name
        data_type: string
        description: "{{ doc('column__city_name') }}"

      - name: county_name
        data_type: string
        description: "{{ doc('column__county_name') }}"

      - name: municipality_name
        data_type: string
        description: "{{ doc('column__municipality_name') }}"

      - name: is_active
        data_type: boolean
        description: "{{ doc('column__is_active_postal_code') }}"
        data_tests:
          - not_null

      - name: has_geofence
        data_type: boolean
        description: "{{ doc('column__has_geofence') }}"

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        
      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"


  - name: operations__zones
    description: > 
      A zone is a logistics construct defining which postal codes will be covered by a certain transport company, for a certain timeblock, for a certain brand. 
      Each zone has a period_from and period_to that determines the menu weeks for which it is valid. 
      This table contains all zones in the operations database.
    columns:
      - name: zone_id
        data_type: int
        description: "{{ doc('column__zone_id') }}"
        data_tests:
          - not_null
          - unique

      - name: company_id
        data_type: varchar(36)
        description: "{{ doc('column__company_id') }}"
        data_tests:
          - not_null

      - name: transport_company_id
        data_type: int
        description: "{{ doc('column__transport_company_id') }}"
        data_tests:
          - not_null

      - name: timeblock_id
        data_type: int
        description: "{{ doc('column__timeblock_id') }}"
        data_tests:
          - not_null

      - name: is_active
        data_type: boolean
        description: "{{ doc('column__is_active_zone') }}"
        data_tests:
          - not_null

      - name: menu_year_week_from
        data_type: int
        description: "{{ doc('column__menu_year_week_from_zones') }}"
        data_tests:
          - not_null

      - name: menu_year_week_to
        data_type: int
        description: "{{ doc('column__menu_year_week_to_zones') }}"
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        
      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"
        
  - name: operations__cases
    description: >
      Cases related to deliveries reported by the customer, customer service or partners. 
      Each delivery can only have one case, but a case can have several case lines.
    config:
      contract:
        enforced: false
    columns:
      - name: case_id
        data_type: char(36)
        description: "{{ doc('column__case_id') }}"
        data_tests:
          - unique
          - not_null

      - name: ops_order_id
        data_type: bigint
        description: "{{ doc('column__ops_order_id') }}"
        data_tests:
          - unique
          - not_null

      - name: redelivery_timeblock_id
        data_type: int
        description: "{{ doc('column__redelivery_timeblock_id') }}"

      - name: case_status_id
        data_type: int
        description: "{{ doc('column__case_status_id') }}"
        data_tests:
          - not_null

      - name: redelivery_status_id
        data_type: int
        description: "{{ doc('column__redelivery_status_id') }}"
        data_tests:
          - not_null

      - name: redelivery_comment
        data_type: string
        description: "{{ doc('column__redelivery_comment') }}"

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        data_tests:
          - not_null

      - name: redelivery_at
        data_type: timestamp
        description: "{{ doc('column__redelivery_at') }}"

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"

  - name: operations__case_lines
    description: >
      Cases lines related to cases that are connected to a delivery. 
      Each delivery can only have one case, but a case can have several case lines.
    config:
      contract:
        enforced: false
    columns:
      - name: case_line_id
        data_type: varchar(36)
        description: "{{ doc('column__case_line_id') }}"
        data_tests:
          - unique
          - not_null

      - name: case_id
        data_type: varchar(36)
        description: "{{ doc('column__case_id') }}"

      - name: billing_agreement_order_line_id
        data_type: varchar(36)
        description: "{{ doc('column__billing_agreement_order_line_id') }}"

      - name: case_line_type_id
        data_type: int
        description: "{{ doc('column__case_line_type_id') }}"
        data_tests:
          - not_null

      - name: case_cause_id
        data_type: varchar(36)
        description: "{{ doc('column__case_cause_id') }}"

      - name: case_responsible_id
        data_type: varchar(36)
        description: "{{ doc('column__case_responsible_id') }}"

      - name: case_category_id
        data_type: varchar(36)
        description: "{{ doc('column__case_category_id') }}"

      - name: case_line_comment
        data_type: string
        description: "{{ doc('column__case_line_comment') }}"

      - name: case_line_amount
        data_type: decimal(19,4)
        description: "{{ doc('column__case_line_amount') }}"

      - name: is_active_case_line
        data_type: boolean
        description: "{{ doc('column__is_active_case_line') }}"

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        data_tests:
          - not_null

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"
        data_tests:
          - not_null

  - name: operations__case_line_types
    description: "Table containing the different types of cases"
    config:
      contract:
        enforced: false
    columns:
      - name: case_line_type_id
        data_type: int
        description: "{{ doc('column__case_line_type_id') }}"
        data_tests:
          - unique
          - not_null

      - name: case_line_type_name
        data_type: string
        description: "{{ doc('column__case_line_type_name') }}"
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"
        data_tests:
          - not_null

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"
        data_tests:
          - not_null

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        data_tests:
          - not_null

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"
        data_tests:
          - not_null

  - name: operations__case_line_ingredients
    description: "Table containing info about ingredients related to cases"
    config:
      contract:
        enforced: false
    columns:
      - name: case_line_id
        data_type: char(36)
        description: "{{ doc('column__case_line_id') }}"

      - name: product_type_id
        data_type: char(36)
        description: "{{ doc('column__product_type_id') }}"

      - name: ingredient_name
        data_type: string
        description: "{{ doc('column__ingredient_name') }}"
        data_tests:
          - not_null

      - name: ingredient_supplier_name
        data_type: string
        description: "{{ doc('column__ingredient_supplier_name') }}"
        data_tests:
          - not_null

      - name: ingredient_internal_reference
        data_type: string
        description: "{{ doc('column__ingredient_internal_reference') }}"
        data_tests:
          - not_null

      - name: ingredient_price
        data_type: decimal(18,0)
        description: "{{ doc('column__ingredient_price') }}"
        data_tests:
          - not_null

      - name: ingredient_quantity
        data_type: int
        description: "{{ doc('column__ingredient_quantity') }}"
        data_tests:
          - not_null

  - name: operations__case_causes
    description: "Table containing the different causes of cases"
    config:
      contract:
        enforced: false
    columns:
      - name: case_cause_id
        data_type: char(36)
        description: "{{ doc('column__case_cause_id') }}"
        data_tests:
          - unique
          - not_null

      - name: case_cause_name
        data_type: string
        description: "{{ doc('column__case_cause_name') }}"
        data_tests:
          - not_null

  - name: operations__case_categories
    description: "Table containing the different case categories"
    config:
      contract:
        enforced: false
    columns:
      - name: case_category_id
        data_type: char(36)
        description: "{{ doc('column__case_category_id') }}"
        data_tests:
          - unique
          - not_null

      - name: case_category_name
        data_type: string
        description: "{{ doc('column__case_category_name') }}"
        data_tests:
          - not_null

  - name: operations__case_responsible
    description: "Table containing the different responsible parties for cases"
    config:
      contract:
        enforced: false
    columns:
      - name: case_responsible_id
        data_type: char(36)
        description: "{{ doc('column__case_responsible_id') }}"
        data_tests:
          - unique
          - not_null

      - name: case_responsible_description
        data_type: string
        description: "{{ doc('column__case_responsible_description') }}"
        data_tests:
          - not_null

  - name: operations__cutoffs
    description: "Names and descriptions of all cutoffs. Cutoff is a timestamp when orders become locked for a particular menu week and country. There is a cutoff for each country and an additional cutoff for Godt Matlyst (external company). It is usually scheduled for the same time every week. Changes are often enforced around red days."
    columns:
      - name: cutoff_id
        data_type: char(36)
        description: "{{ doc('column__cutoff_id') }}"
        data_tests:
          - unique
          - not_null

      - name: country_id
        data_type: char(36)
        description: "{{ doc('column__country_id') }}"
        data_tests:
          - not_null

      - name: cutoff_name
        data_type: string
        description: "{{ doc('column__cutoff_name') }}"
        data_tests:
          - not_null

      - name: cutoff_description
        data_type: string
        description: "{{ doc('column__cutoff_description') }}"

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"

  - name: operations__cutoff_calendar
    description: "The timestamps of all cutoffs for each menu year and menu week in both local time and utc time. Cutoff is a timestamp when orders become locked for a particular menu week and country. There is a cutoff for each country and an additional cutoff for Godt Matlyst (external company). It is usually scheduled for the same time every week. Changes are often enforced around red days."
    columns:
      - name: cutoff_calendar_id
        data_type: char(36)
        description: "{{ doc('column__cutoff_calendar_id') }}"
        data_tests:
          - unique
          - not_null

      - name: cutoff_id
        data_type: char(36)
        description: "{{ doc('column__cutoff_id') }}"
        data_tests:
          - not_null

      - name: menu_year
        data_type: int
        description: "{{ doc('column__menu_year') }}"
        data_tests:
          - not_null

      - name: menu_week
        data_type: int
        description: "{{ doc('column__menu_week') }}"
        data_tests:
          - not_null

      - name: cutoff_at_local_time
        data_type: timestamp
        description: "{{ doc('column__cutoff_at_local_time') }}"
        data_tests:
          - not_null

      - name: cutoff_at_utc
        data_type: timestamp
        description: "{{ doc('column__cutoff_at_utc') }}"
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"

  - name: operations__geofences
    description: "Associated information about geofences - geographical areas that are used for logistics purposes."
    columns:
      - name: geofence_id
        data_type: char(36)
        description: "{{ doc('column__geofence_id') }}"
        data_tests:
          - not_null
          - unique

      - name: country_id
        data_type: char(36)
        description: "{{ doc('column__country_id') }}"
        data_tests:
          - not_null
      
      - name: geofence_layer_id
        data_type: string
        description: "{{ doc('column__geofence_layer_id') }}"
        data_tests:
          - not_null

      - name: geofence_container_id
        data_type: string
        description: "{{ doc('column__geofence_container_id') }}"
        data_tests:
          - not_null

      - name: geofence_polygon_id
        data_type: string
        description: "{{ doc('column__geofence_polygon_id') }}"
        data_tests:
          - not_null

      - name: geofence_layer_name
        data_type: string
        description: "{{ doc('column__geofence_layer_name') }}"
        data_tests:
          - not_null

      - name: geofence_container_name
        data_type: string
        description: "{{ doc('column__geofence_container_name') }}"
        data_tests:
          - not_null

      - name: geofence_polygon_name
        data_type: string
        description: "{{ doc('column__geofence_polygon_name') }}"
        data_tests:
          - not_null

      - name: is_active
        data_type: boolean
        description: "{{ doc('column__is_active_geofence') }}"
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"
        data_tests:
          - not_null

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"
        data_tests:
          - not_null

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        data_tests:
          - not_null

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"
        data_tests:
          - not_null

      - name: valid_from
        data_type: timestamp
        description: "{{ doc('column__valid_from') }}"
        data_tests:
          - not_null

      - name: valid_to
        data_type: timestamp
        description: "{{ doc('column__valid_to') }}"
        data_tests:
          - not_null


  - name: operations__geofence_postal_codes
    description: "Postal codes and associated geofences."
    columns:
      - name: geofence_postal_code_id
        data_type: char(36)
        description: "{{ doc('column__geofence_postal_code_id') }}"
        data_tests:
          - not_null
          - unique

      - name: geofence_id
        data_type: char(36) 
        description: "{{ doc('column__geofence_id') }}"
        data_tests:
          - not_null

      - name: country_id
        data_type: char(36)
        description: "{{ doc('column__country_id') }}"
        data_tests:
          - not_null

      - name: postal_code_id
        data_type: int
        description: "{{ doc('column__postal_code_id') }}"
        data_tests:
          - not_null

      - name: is_active
        data_type: boolean
        description: "{{ doc('column__is_active_geofence_postal_code') }}"
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"
        data_tests:
          - not_null

      - name: source_created_by
        data_type: string
        description: "{{ doc('column__source_created_by') }}"
        data_tests:
          - not_null

      - name: source_updated_at
        data_type: timestamp
        description: "{{ doc('column__source_updated_at') }}"
        data_tests:
          - not_null

      - name: source_updated_by
        data_type: string
        description: "{{ doc('column__source_updated_by') }}"
        data_tests:
          - not_null

      - name: valid_from
        data_type: timestamp
        description: "{{ doc('column__valid_from') }}"
        data_tests:
          - not_null

      - name: valid_to
        data_type: timestamp
        description: "{{ doc('column__valid_to') }}"
        data_tests:
          - not_null