# DOUCMENTATION: https://docs.getdbt.com/reference/model-properties

version: 2

models:
  - name: analyticsdb_analytics__billing_agreement_basket_products_log
    description: "Log table of basket products from AnalyticsDB. Was run before every cutoff."
    columns:
      - name: billing_agreement_basket_id
        data_type: varchar(36)
        description: "{{ doc('column__billing_agreement_basket_id') }}"
        data_tests:
          - not_null

      - name: product_variation_id
        data_type: varchar(36)
        description: "{{ doc('column__product_variation_id') }}"
        data_tests:
          - not_null

      - name: product_delivery_week_type_id
        data_type: int
        description: "{{ doc('column__delivery_week_type_id') }}"
        data_tests:
          - not_null

      - name: product_variation_quantity
        data_type: int
        description: "{{ doc('column__product_variation_quantity') }}"
        data_tests:
          - not_null

      - name: is_extra_product
        data_type: boolean
        description: "{{ doc('column__is_extra_basket_product') }}"

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"
        data_tests:
          - not_null

  - name: analyticsdb_snapshots__historical_billing_agreement_statuses
    description: "A daily snapshot table of billing_agreement_ids with statuses from AnalyticsDB. Deleted agreements are not included."
    columns:
      - name: billing_agreement_id
        data_type: int
        description: "{{ doc('column__billing_agreement_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: billing_agreement_status_id
        data_type: int
        description: "{{ doc('column__billing_agreement_status_id') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null

      - name: source_created_at
        data_type: timestamp
        description: "{{ doc('column__source_created_at') }}"
        constraints:
          - type: not_null
        data_tests:
          - not_null
  
  - name: analyticsdb_orders__historical_orders
  - name: analyticsdb_orders__historical_order_lines